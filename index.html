<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="todo.css">
    
    <title>ToDo list</title>
</head>
<body>

    <div id="container">
        <h1>My To Do List</h1>

            
    </div>
    
    <script src="notes.js"></script>
      <script>
          class Note{
              constructor(titre,dateCreation,couleur,rappel){
                  if(typeof titre === "string") this._titre = titre;
                  if(typeof dateCreation === "string") this._dateCreation = dateCreation;
                  if(typeof couleur === "string" && ["red","orange","yellow","green"].includes(couleur)){this._couleur = couleur;}
                  if(typeof rappel === "string") this._rappel = rappel;

              }
              static displayNotes(notesArray,container){
                for(let note of notesArray){
                    container.insertAdjacentElement('beforeend',note.render());
                }
              }
              //getters//
              get titre(){
                  return this._titre;
              }

              

              get dateCreation(){
                  return this._dateCreation;
              }

              get couleur(){
                  return this._couleur;
              }

              get rappel(){
                  return this._rappel;
              }

              //setters//
              set titre(titre){
                  if(typeof titre === "string"){
                      this._titre = titre;
                  }
              }

              

              set dateCreation(dateCreation){
                  if(typeof dateCreation === "string"){
                      this._dateCreation = dateCreation;
                  }
              }

              /*set couleur(couleur){
                  if(["red","orange","yellow","green"].includes(couleur)){
                        this._couleur = couleur;
                    }
                  
              }*/ 

              set couleur(couleur){
                  if(typeof couleur === "string"){
                      this._couleur = couleur;
                  }
              }

              set rappel(rappel){
                if(typeof rappel === "string"){
                      this._rappel = rappel;
                  }
              }

        }
        
        class TextNote extends Note{
            constructor(titre,texte,dateCreation,couleur,rappel){
                super(titre,dateCreation,couleur,rappel);
                if(typeof texte === "string")this._texte = texte;
            }
            render(){
                
                


                let newElt = document.createElement("div");
                newElt.innerHTML = `
                <h2>${this.titre}</h2>
                <p><strong>${this.texte}</strong></p>
                <p> création: <strong>${this.dateCreation}</strong></p>
                <p> rappel : ${this.rappel}</p>`;
                newElt.style.background = this.couleur;
                newElt.style.border = "2px solid black";
                newElt._noteReference_ = this;
                let colorsMapping = {
                rouge: "red",
                orange: "orange",
                jaune: "yellow",
                vert: "green"
                };
                colorsMapping[this.couleur];
                return newElt;
            }


            get texte(){
                return this._texte;
            }
            set texte(texte){
                if(typeof texte === "string"){
                    this._texte = texte;
                }
            }
        }

        

        class CheckListNote extends Note{
            constructor(titre,toDo,dateCreation,couleur,rappel){
                super(titre,dateCreation,couleur,rappel);
                if(toDo instanceof Array) this._toDo = toDo;
            }

            get toDo(){
                return this._toDo;
            }

            set toDo(toDo){
                if(toDo instanceof Array) this._toDo = toDo;
            }
            render(){
            


                let newElt = document.createElement("div");
                newElt.innerHTML = `
                <input type="checkbox" value="1" checked> A faire
                <input type="checkbox" value="2"> Fait
                <h2>${this.titre}</h2>
                
                <p>création: <strong>${this.dateCreation}</strong></p>
                <p> rappel: ${this.rappel}</p>
                `;
                for(let objetTache of this.toDo){
                    for(let prop in objetTache){
                   newElt.innerHTML  += `<h2>${prop}:  ${objetTache[prop]}</h2>`
                    }
                }
                newElt.style.background = this.couleur;
                
                newElt.style.border = "2px solid black";
                newElt._noteReference_ = this;
                let colorsMapping = {
                rouge: "red",
                orange: "orange",
                jaune: "yellow",
                vert: "green"
                };
                colorsMapping[this.couleur];
                return newElt;
            }
        }
        



let notesArray = [];        
let notesParsees = JSON.parse(notesJSON
);

function instantiateNotes(noteParsees,notesArray){
    for(let noteParsee of notesParsees){
        if(noteParsee.texte !== undefined){
        var note = new TextNote(noteParsee.titre,noteParsee.texte,noteParsee.date,noteParsee.couleur,noteParsee.dateRappel);
            }
        else if(noteParsee.toDo !== undefined){
        var note = new CheckListNote(noteParsee.titre,noteParsee.toDo,noteParsee.date,noteParsee.couleur,noteParsee.dateRappel);
        }
        notesArray.unshift(note);
    }  
    
    return notesArray;
}



noteA = new CheckListNote("courses",[{"faire des courses chez Aldi":true}],"04/03/2021","yellow","null");

noteB = new TextNote("React","React est une bibliothèque JavaScript libre développée par Facebook depuis 2013.","20/03/2021","red","null");

notesArray.unshift(noteB);
notesArray.unshift(noteA);


instantiateNotes(notesParsees,notesArray);

Note.displayNotes(notesArray,document.querySelector('#container'));







      </script>
</body>
</html>


